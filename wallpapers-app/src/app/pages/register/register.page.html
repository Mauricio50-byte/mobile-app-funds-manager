<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/login"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ translationService.translate('register.title') }}</ion-title>
    <ion-buttons slot="end">
      <app-language-toggle></app-language-toggle>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="register-container">
    <div class="logo-section">
      <ion-icon name="person-add-outline" size="large" color="primary"></ion-icon>
      <h1>{{ translationService.translate('register.title') }}</h1>
      <p>{{ translationService.translate('register.subtitle') }}</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
      <!-- Campo de nombre -->
      <app-input
        [label]="translationService.translate('common.name')"
        type="text"
        [placeholder]="translationService.translate('register.namePlaceholder')"
        formControlName="name"
        [showError]="!!(registerForm.get('name')?.invalid && registerForm.get('name')?.touched)"
        [errorMessage]="getNameErrorMessage()">
      </app-input>

      <!-- Campo de apellido -->
      <app-input
        [label]="translationService.translate('common.lastName')"
        type="text"
        [placeholder]="translationService.translate('register.lastNamePlaceholder')"
        formControlName="lastName"
        [showError]="!!(registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched)"
        [errorMessage]="getLastNameErrorMessage()">
      </app-input>

      <!-- Campo de email -->
      <app-input
        [label]="translationService.translate('common.email')"
        type="email"
        [placeholder]="translationService.translate('register.emailPlaceholder')"
        formControlName="email"
        [showError]="!!(registerForm.get('email')?.invalid && registerForm.get('email')?.touched)"
        [errorMessage]="getEmailErrorMessage()">
      </app-input>

      <!-- Campo de contraseña -->
      <app-input
        [label]="translationService.translate('common.password')"
        type="password"
        [placeholder]="translationService.translate('register.passwordPlaceholder')"
        formControlName="password"
        [showError]="!!(registerForm.get('password')?.invalid && registerForm.get('password')?.touched)"
        [errorMessage]="getPasswordErrorMessage()">
      </app-input>

      <!-- Campo de confirmación de contraseña -->
      <app-input
        [label]="translationService.translate('common.confirmPassword')"
        type="password"
        [placeholder]="translationService.translate('register.confirmPasswordPlaceholder')"
        formControlName="confirmPassword"
        [showError]="!!((registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched) || registerForm.errors?.['passwordMismatch'])"
        [errorMessage]="getConfirmPasswordErrorMessage()">
      </app-input>

      <!-- Botón de registro -->
      <app-button
        [text]="translationService.translate('register.registerButton')"
        type="submit"
        [disabled]="registerForm.invalid || isLoading"
        [loading]="isLoading"
        (buttonClick)="onRegister()"
        class="register-button">
      </app-button>
    </form>

    <!-- Separador -->
    <div class="separator">
      <span>{{ translationService.translate('register.or') }}</span>
    </div>

    <!-- Botón de Google -->
    <button 
      class="google-signin-button" 
      (click)="onGoogleRegister()" 
      [disabled]="isLoading">
      <div class="google-icon">
        <svg width="18" height="18" viewBox="0 0 18 18">
          <path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"/>
          <path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2.04a4.8 4.8 0 0 1-7.18-2.53H1.83v2.07A8 8 0 0 0 8.98 17z"/>
          <path fill="#FBBC05" d="M4.5 10.49a4.8 4.8 0 0 1 0-3.07V5.35H1.83a8 8 0 0 0 0 7.28l2.67-2.14z"/>
          <path fill="#EA4335" d="M8.98 3.58c1.32 0 2.5.45 3.44 1.35l2.54-2.54a8 8 0 0 0-5.98-2.39 8 8 0 0 0-7.15 4.42l2.67 2.14c.63-1.89 2.39-3.18 4.48-3.18z"/>
        </svg>
      </div>
      <span class="google-text">{{ translationService.translate('register.googleButton') }}</span>
    </button>

    <!-- Enlace a inicio de sesión -->
    <div class="login-link">
      <p>{{ translationService.translate('register.hasAccount') }}</p>
      <app-button
        [text]="translationService.translate('register.loginLink')"
        fill="clear"
        (buttonClick)="goToLogin()">
      </app-button>
    </div>
  </div>
</ion-content>
